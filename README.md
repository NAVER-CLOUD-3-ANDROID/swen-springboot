# λ‰΄μ¤ TTS + RAG μ¶”μ² μ„λΉ„μ¤ API

λ„¤μ΄λ²„ λ‰΄μ¤ API, HyperCLOVA, Clova Voiceλ¥Ό μ—°λ™ν• λ‰΄μ¤ μ½μ–΄μ£ΌκΈ° + AI κ΄€λ ¨ λ‰΄μ¤ μ¶”μ² μ„λΉ„μ¤μ…λ‹λ‹¤.

## π€ μ£Όμ” κΈ°λ¥

### 1. πµ ν”λ μ΄ λ²„νΌ κΈ°λ¥ (λ©”μΈ)
- **κ°„νΈ λλ¤ λ‰΄μ¤**: `GET /api/v1/news/play` - ν΄λ¦­ ν• λ²μΌλ΅ 1λ¶„ λ‚΄ λ‹¤μ •ν• λ©μ†λ¦¬λ΅ λλ¤ μµμ‹  λ‰΄μ¤ μ¬μƒ
- **π¤– AI κ΄€λ ¨ λ‰΄μ¤ μ¶”μ²**: RAG κΈ°λ°μΌλ΅ μ¬μƒν• λ‰΄μ¤μ™€ κ΄€λ ¨λ λ‰΄μ¤ 3-5κ° μλ™ μ¶”μ²
- **λ§μ¶¤ λ‰΄μ¤**: μ£Όμ  μ…λ ¥ μ‹ ν•΄λ‹Ή λ‰΄μ¤ 1κ°λ§ μ²λ¦¬
- **κ³ μ • μ„¤μ •**: λ‹¤μ •ν•κ³  κΉ”λ”ν• λ©μ†λ¦¬, κΈ°λ³Έ 1λ¶„ λ‚΄ μ¤ν¬λ¦½νΈ

### 2. π¤– RAG μ¶”μ² μ‹μ¤ν…
- **λ²΅ν„° κ²€μƒ‰**: HyperCLOVA EmbeddingμΌλ΅ λ‰΄μ¤ μλ―Έ λ²΅ν„°ν™” ν›„ μ μ‚¬λ„ κ²€μƒ‰
- **μλ™ ν•™μµ**: μ‚¬μ©ν• μλ΅ μ¶”μ² ν’μ§ ν–¥μƒ
- **μ½λ“ μ¤νƒ€νΈ ν•΄κ²°**: μ΄κΈ°μ—λ” ν‚¤μ›λ“ κΈ°λ° μ‹¤μ‹κ°„ μ¶”μ²
- **μλ™ μμ§‘**: μ¤μΌ€μ¤„λ¬λ΅ λ§¤μΌ μµμ‹  λ‰΄μ¤ μλ™ μ„λ² λ”©

### 3. κ°λ³„ κΈ°λ¥
- λ‰΄μ¤ κ²€μƒ‰λ§ μ‹¤ν–‰
- μ¤ν¬λ¦½νΈ μƒμ„±λ§ μ‹¤ν–‰  
- TTS λ³€ν™λ§ μ‹¤ν–‰
- κ΄€λ ¨ λ‰΄μ¤ μ¶”μ²λ§ μ‹¤ν–‰

## π“΅ API μ—”λ“ν¬μΈνΈ

### πµ ν”λ μ΄ λ²„νΌ (λ©”μΈ κΈ°λ¥)

#### κ°„νΈ λ²„μ „ (GET) - μ•± ν”λ μ΄ λ²„νΌμ©
```http
GET /api/v1/news/play
```
**π”¥ μ•±μ ν”λ μ΄ λ²„νΌμ—μ„ λ°”λ΅ μ‚¬μ©ν•μ„Έμ”! 1λ¶„ λ‚΄ λ‹¤μ •ν• λ©μ†λ¦¬λ΅ λλ¤ λ‰΄μ¤ μ¬μƒ + κ΄€λ ¨ λ‰΄μ¤ μ¶”μ²**

#### μƒμ„Έ μ„¤μ • (POST)
```http
POST /api/v1/news/play
```

**μ”μ²­ μμ‹ (λ¨λ“  ν•„λ“ μ„ νƒμ‚¬ν•­):**
```json
{
    "topic": "AI μΈκ³µμ§€λ¥",        // μ—†μΌλ©΄ λλ¤ μµμ‹  λ‰΄μ¤
    "scriptLength": "SHORT"       // κΈ°λ³Έκ°’: "SHORT" (1λ¶„ λ‚΄)
}
```

**μ‘λ‹µ μμ‹ (κΈ€λ΅λ² μ‘λ‹µ μ‹μ¤ν…):**
```json
{
    "isSuccess": true,
    "status": 200,
    "data": {
        "scriptId": "uuid-string",
        "script": "μƒμ„±λ λ‰΄μ¤ μ¤ν¬λ¦½νΈ λ‚΄μ©...",
        "sourceNews": [
            {
                "title": "λ‰΄μ¤ μ λ©",
                "description": "λ‰΄μ¤ μ”μ•½",
                "publisher": "μ–Έλ΅ μ‚¬",
                "link": "λ‰΄μ¤ λ§ν¬"
            }
        ],
        "audioUrl": "μƒμ„±λ μμ„± νμΌ URL",
        "recommendedNews": [
            {
                "title": "κ΄€λ ¨ λ‰΄μ¤ 1",
                "description": "AI κΈ°λ° μ¶”μ²λ κ΄€λ ¨ λ‰΄μ¤",
                "publisher": "ν…ν¬λ‰΄μ¤",
                "link": "κ΄€λ ¨λ‰΄μ¤λ§ν¬"
            }
        ],
        "status": "COMPLETED",
        "createdAt": "2025-01-15T10:30:00"
    },
    "timestamp": "2025-01-15T10:30:00"
}
```

### π¤– κ΄€λ ¨ λ‰΄μ¤ μ¶”μ²

```http
POST /api/v1/news/recommendations
```

**μ”μ²­ μμ‹:**
```http
POST /api/v1/news/recommendations
Content-Type: application/x-www-form-urlencoded

title=ν„μ¬λ‰΄μ¤μ λ©&description=λ‰΄μ¤λ‚΄μ©&publisher=μ–Έλ΅ μ‚¬&link=λ‰΄μ¤λ§ν¬
```

### π” λ‰΄μ¤ κ²€μƒ‰ (λ‹¨κ±΄)

```http
GET /api/v1/news/search
```

**μ‚¬μ© μμ‹:**
```http
# νΉμ • μ£Όμ  λ‰΄μ¤ 1κ±΄
GET /api/v1/news/search?query=AI

# λλ¤ μµμ‹  λ‰΄μ¤ 1κ±΄  
GET /api/v1/news/search
```

### π“ μ¤ν¬λ¦½νΈ μƒμ„±
```http
POST /api/v1/news/script?title=λ‰΄μ¤μ λ©&description=λ‰΄μ¤λ‚΄μ©&scriptLength=SHORT
```

### π¤ TTS λ³€ν™
```http
POST /api/v1/news/tts?script=λ³€ν™ν• ν…μ¤νΈ
```

### π”§ κ΄€λ¦¬μ API
```http
# λ‰΄μ¤ μ„λ² λ”© λ°°μΉ μ‘μ—… μλ™ μ‹¤ν–‰
POST /api/v1/news/admin/embedding/batch

# λ²΅ν„°DB ν†µκ³„ μ΅°ν
GET /api/v1/news/admin/embedding/stats
```

## β™οΈ μ„¤μ •

### ν•„μ ν™κ²½ λ³€μ
```env
# λ„¤μ΄λ²„ API
NAVER_CLIENT_ID=λ„¤μ΄λ²„_ν΄λΌμ΄μ–ΈνΈ_ID
NAVER_CLIENT_SECRET=λ„¤μ΄λ²„_ν΄λΌμ΄μ–ΈνΈ_μ‹ν¬λ¦Ώ

# HyperCLOVA (μ¤ν¬λ¦½νΈ μƒμ„± + μ„λ² λ”©)
NAVER_HYPERCLOVA_API_KEY=ν•μ΄νΌν΄λ΅λ°”_API_ν‚¤
NAVER_HYPERCLOVA_EMBEDDING_API_KEY=ν•μ΄νΌν΄λ΅λ°”_μ„λ² λ”©_API_ν‚¤

# Clova Voice (TTS)
CLOVA_VOICE_CLIENT_ID=ν΄λ΅λ°”λ³΄μ΄μ¤_ν΄λΌμ΄μ–ΈνΈ_ID
CLOVA_VOICE_CLIENT_SECRET=ν΄λ΅λ°”λ³΄μ΄μ¤_ν΄λΌμ΄μ–ΈνΈ_μ‹ν¬λ¦Ώ

# NCP Object Storage
NCP_ACCESS_KEY=NCP_μ•΅μ„Έμ¤_ν‚¤
NCP_SECRET_KEY=NCP_μ‹ν¬λ¦Ώ_ν‚¤
NCP_BUCKET_NAME=λ²„ν‚·μ΄λ¦„

# λ°μ΄ν„°λ² μ΄μ¤
DB_URL=jdbc:mysql://localhost:3306/swen_db
DB_USERNAME=μ‚¬μ©μλ…
DB_PASSWORD=λΉ„λ°€λ²νΈ
```

### RAG μ¶”μ² μ„¤μ •
```yaml
# application.yml
vector-db:
  similarity-threshold: 0.6  # μ μ‚¬λ„ μ„κ³„κ°’
  max-recommendations: 5     # μµλ€ μ¶”μ² κ°μ

scheduler:
  news-embedding:
    enabled: true    # μλ™ λ‰΄μ¤ μμ§‘ ν™μ„±ν™”
```

## π¨ μμ„± μ¤νƒ€μΌ

- **κ³ μ • μ„¤μ •**: λ‹¤μ •ν•κ³  κΉ”λ”ν• ν†¤ (nsujin λ³΄μ΄μ¤)
- λ³„λ„ μ„¤μ • λ¶ν•„μ”, μλ™μΌλ΅ μµμ ν™”λ λ©μ†λ¦¬ μ κ³µ

## π“ μ¤ν¬λ¦½νΈ κΈΈμ΄ μµμ…

- **SHORT**: 1λ¶„ λ‚΄ κ°„λ‹¨ν• μ”μ•½ (κΈ°λ³Έκ°’)
- **MEDIUM**: 3λ¶„ λ¶„λ‰μ μ μ ν• κΈΈμ΄
- **LONG**: 5λ¶„ λ¶„λ‰μ μƒμ„Έν• λ‚΄μ©

## π€ μ‹¤ν–‰ λ°©λ²•

### 1. λ΅μ»¬ μ‹¤ν–‰
```bash
# λ°μ΄ν„°λ² μ΄μ¤ μƒμ„±
mysql -u root -p -e "CREATE DATABASE swen_db;"

# μ• ν”λ¦¬μΌ€μ΄μ… μ‹¤ν–‰
./gradlew bootRun
```

### 2. Docker μ‹¤ν–‰
```bash
docker-compose -f docker-compose.dev.yml up
```

## π“ API λ¬Έμ„

μ• ν”λ¦¬μΌ€μ΄μ… μ‹¤ν–‰ ν›„ Swagger UIμ—μ„ μƒμ„Έν• API λ¬Έμ„λ¥Ό ν™•μΈν•  μ μμµλ‹λ‹¤:
- **URL**: http://localhost:8080/swagger-ui.html

## π§ ν…μ¤νΈ

`news-api-test.http` νμΌμ„ μ‚¬μ©ν•μ—¬ APIλ¥Ό ν…μ¤νΈν•  μ μμµλ‹λ‹¤.

## π—οΈ μ•„ν‚¤ν…μ²

```
Frontend (Play Button)
       β†“
   News Controller
       β†“
    News Service
       β†“
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”    β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
β”‚ 1. Naver News   β”‚ β†’  β”‚ 4. RAG μ¶”μ²     β”‚
β”‚ 2. HyperCLOVA   β”‚    β”‚ - λ²΅ν„° κ²€μƒ‰     β”‚
β”‚ 3. Clova Voice  β”‚    β”‚ - μ μ‚¬λ„ κ³„μ‚°   β”‚
β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”    β”‚ - κ΄€λ ¨ λ‰΄μ¤ μ¶”μ²β”‚
       β†“               β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
   Audio + μ¶”μ²λ‰΄μ¤ Response
```

## π”§ κΈ°μ  μ¤νƒ

- **Spring Boot 3.5.3**
- **Spring Cloud OpenFeign** (μ™Έλ¶€ API ν΄λΌμ΄μ–ΈνΈ)
- **MySQL 8.0** + **Spring Data JPA**
- **HyperCLOVA X** (μ¤ν¬λ¦½νΈ μƒμ„± + μ„λ² λ”©)
- **Apache Commons Math** (λ²΅ν„° μ—°μ‚°)
- **Lombok**
- **SpringDoc OpenAPI** (Swagger)
- **κΈ€λ΅λ² μ‘λ‹µ/μμ™Έ μ²λ¦¬ μ‹μ¤ν…**

## β΅ μμ™Έ μ²λ¦¬

λ¨λ“  APIλ” κΈ€λ΅λ² μμ™Έ μ²λ¦¬ μ‹μ¤ν…μ„ μ‚¬μ©ν•©λ‹λ‹¤:

### λ‰΄μ¤ λ„λ©”μΈ μ—λ¬ μ½”λ“
- `NEWS_001`: λ‰΄μ¤ κ²€μƒ‰ μ‹¤ν¨
- `NEWS_101`: μ¤ν¬λ¦½νΈ μƒμ„± μ‹¤ν¨  
- `NEWS_201`: TTS λ³€ν™ μ‹¤ν¨
- `NEWS_401`: μ„λ² λ”© μƒμ„± μ‹¤ν¨
- `NEWS_403`: λ‰΄μ¤ μ¶”μ² μ‹¤ν¨
- `NEWS_302`: μ™Έλ¶€ API μ„λΉ„μ¤ λ¶κ°€

### κ³µν†µ μ‘λ‹µ ν•μ‹
λ¨λ“  API μ‘λ‹µμ€ `CommonResponse<T>` ν•νƒλ΅ λν•‘λ©λ‹λ‹¤:
```json
{
    "isSuccess": boolean,
    "status": number,
    "data": T,
    "timestamp": "2025-01-15T10:30:00"
}
```

## π¤– RAG μ¶”μ² μ‹μ¤ν…

### λ™μ‘ λ°©μ‹
1. **λ‰΄μ¤ μ¬μƒ** β†’ μ¤ν¬λ¦½νΈ μƒμ„± β†’ TTS λ³€ν™
2. **λ²΅ν„° κ²€μƒ‰** β†’ HyperCLOVA μ„λ² λ”©μΌλ΅ κ΄€λ ¨ λ‰΄μ¤ μ°ΎκΈ°
3. **μλ™ ν•™μµ** β†’ μ¬μƒ/μ¶”μ²λ λ‰΄μ¤λ¥Ό λ²΅ν„°DBμ— μ €μ¥
4. **ν’μ§ ν–¥μƒ** β†’ μ‚¬μ©ν• μλ΅ μ¶”μ² μ •ν™•λ„ κ°μ„ 

### μ½λ“ μ¤νƒ€νΈ ν•΄κ²°
- **μ²« μ‚¬μ©μ**: ν‚¤μ›λ“ κΈ°λ° μ‹¤μ‹κ°„ κ²€μƒ‰μΌλ΅ μ¶”μ²
- **μ‹κ°„ κ²½κ³Ό**: RAG λ²΅ν„° κ²€μƒ‰μΌλ΅ κ³ ν’μ§ μ¶”μ²
- **μλ™ μμ§‘**: μ¤μΌ€μ¤„λ¬λ΅ λ§¤μΌ μµμ‹  λ‰΄μ¤ ν•™μµ

## π“ λΌμ΄μ„Όμ¤

μ΄ ν”„λ΅μ νΈλ” MIT λΌμ΄μ„Όμ¤ ν•μ— λ°°ν¬λ©λ‹λ‹¤.
